<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Landing Page</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav id="menu">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="my wardrobe.html">My Wardrobe</a></li>
        </ul>
    </nav>

    <h1>Good morning, User!</h1>
    
    <div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
        <div>
            <div>Today's weather in</div>
            <div><span id="city"></span></div>
        </div>
        <div><span id="temp"></span>Â°C</div>
    </div>

    <script>
    const API_KEY = "AIzaSyDb0KKbPhTf5aetgaB36e3HMF31Qmbu7hg"; 
    const LAT = 49.246292; // Vancouver Latitude
    const LON = -123.116226; // Vancouver Longitude

    fetch(`https://weather.googleapis.com/v1/currentConditions:lookup?key=${API_KEY}&location.latitude=${LAT}&location.longitude=${LON}`)
    .then(res => res.json())
    .then(data => {
        console.log(data);
        
        if (data.error) {
            throw new Error(data.error.message);
        }
        
        // Temperature in Celsius from the first result
        const temperature = data?.feelsLikeTemperature?.degrees ?? "-";

        const cityName = "Vancouver, British Columbia";

        // Update HTML
        document.getElementById("city").textContent = cityName;
        document.getElementById("temp").textContent = temperature;
    })
    .catch(err => {
        console.error("Error fetching weather:", err);
        document.getElementById("city").textContent = "Error";
        document.getElementById("temp").textContent = "-";
    });
    </script>

    <h2>Special Occasion?</h2>
    <textarea id="promptInput" rows="4" cols="50" placeholder="e.g. office event, date night, brunch"></textarea><br>
    <p>Get your perfect outfit from your personal AI stylist.</p>
    <button id="submitBtn">Submit</button>
    <h2>An outfit for your consideration:</h2>
    <div id="responseOutput"></div>

    <script>
        const GEMINI_API_KEY = "AIzaSyDZiTiGYC-8yxVVYl3e5tXdCm1rpjd0zxQ";

        const submitBtn = document.getElementById("submitBtn");
        const promptInput = document.getElementById("promptInput");
        const responseOutput = document.getElementById("responseOutput");

        const systemPrompt = "Reply by listing one top and one bottom, in the format [top colour] [top type] [bottom colour] [bottom type] with the brackets in place, colours should only be basic colour names, but type can be more in detail. Colour and type should be in different brackets.\n";

        submitBtn.addEventListener("click", async () => {
            const userPrompt = promptInput.value.trim(); 
            if (!userPrompt) {
                responseOutput.textContent = "Please enter a prompt.";
                return;
            }

            const fullPrompt = `${systemPrompt}${userPrompt}`;

            responseOutput.textContent = "Loading...";

            try {
                const resp = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "x-goog-api-key": GEMINI_API_KEY
                    },
                    body: JSON.stringify({
                        contents: [
                            {
                                parts: [
                                    {
                                        text: fullPrompt
                                    }
                                ]
                            }
                        ]
                    })
                });

                if (!resp.ok) {
                    const err = await resp.json();
                    throw new Error(err.error?.message || `HTTP error ${resp.status}`);
                }

                const data = await resp.json();
                console.log(data);
                // The response JSON has a structure; usually the generated text is inside something like data.choices or data.contents or similar
                // Based on docs, data.contents[0].parts[0].text is common
                let outputText = "";

                responseOutput.textContent = data?.candidates?.[0]?.content?.parts?.[0]?.text;
            } catch (err) {
                console.error(err);
                responseOutput.textContent = "Error: " + err.message;
            }
        });
    </script>
</body>
</html>